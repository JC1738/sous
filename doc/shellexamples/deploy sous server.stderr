
bash-3.2$ git clone ssh://root@192.168.99.100:2222/repos/sous-server
Cloning into 'sous-server'...
ssh_wrapper
Warning: Permanently added '[192.168.99.100]:2222' (ECDSA) to the list of known hosts.
bash-3.2$ pushd sous-server
bash-3.2$ SOUS_SERVER= SOUS_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz<_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz9                         2mrn16vkfds/T/sous-cli-te<rs/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-tes                         ting238723182/gdm sous in<mrn16vkfds/T/sous-cli-testing238723182/gdm sous ini                         t -v -d
vomit: 2017/01/30 17:03:47 graph.go:295: Verbose debugging enabled
debug: 2017/01/30 17:03:47 graph.go:296: Regular debugging enabled
warn: No server set, Sous is running in server or workstation mode.
warn: Configure a server like this: sous config server http://some.sous.server
warn: Using local state stored at /var/folders/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-testing238723182/gdm
debug: 2017/01/30 17:03:47 git_state_manager.go:55: [git pull]: error: exit status 1
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: ssh_wrapper
Can't open user config file none/dot-ssh/config: No such file or directory
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
vomit: 2017/01/30 17:03:47 disk_state_manager.go:65: Reading state from disk
vomit: 2017/01/30 17:03:47 disk_state_manager.go:45: Validating State
vomit: 2017/01/30 17:03:47 disk_state_manager.go:48: Repairing State
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git tag sous-fallback-e9dfb3ba-a188-4ce4-8e84-da4abe249e07]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: 
vomit: 2017/01/30 17:03:47 disk_state_manager.go:45: Validating State
vomit: 2017/01/30 17:03:47 disk_state_manager.go:48: Repairing State
vomit: 2017/01/30 17:03:47 disk_state_manager.go:100: Writing state to disk
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git add .]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: 
debug: 2017/01/30 17:03:47 git_state_manager.go:55: [git diff-index --exit-code HEAD]: error: exit status 1
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: :100644 100644 0cff63bd3996d393983dcebf2ccb26cc570e8d78 143bfab2a6b3b90f34389146e1575e4b61e4b37c M	defs.yaml
:000000 100644 0000000000000000000000000000000000000000 f524621b01746387e3168c8883627d69f2e9c196 A	manifests/192.168.99.100/2222/repos/sous-server.yaml
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git commit -m sous commit: Update State]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: [master f1fc00d] sous commit: Update State
 Committer: Judson Lester <jlester@MBP15JLESTER-3.local>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 22 insertions(+), 2 deletions(-)
 create mode 100644 manifests/192.168.99.100/2222/repos/sous-server.yaml
debug: 2017/01/30 17:03:47 git_state_manager.go:55: [git push -u origin master]: error: exit status 128
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: ssh_wrapper
Can't open user config file none/dot-ssh/config: No such file or directory
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git reset --hard sous-fallback-e9dfb3ba-a188-4ce4-8e84-da4abe249e07]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: HEAD is now at 5a452a4 Adding defs.yaml
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git clean -f]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: 
debug: 2017/01/30 17:03:47 git_state_manager.go:53: [git tag -d sous-fallback-e9dfb3ba-a188-4ce4-8e84-da4abe249e07]: success
vomit: 2017/01/30 17:03:47 git_state_manager.go:57: git: Deleted tag 'sous-fallback-e9dfb3ba-a188-4ce4-8e84-da4abe249e07' (was 5a452a4)
debug: 2017/01/30 17:03:47 cli.go:23: git push -u origin master: ssh_wrapper
Can't open user config file none/dot-ssh/config: No such file or directory
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
: exit status 128
debug: 2017/01/30 17:03:47 cli.go:164: git push -u origin master: ssh_wrapper
Can't open user config file none/dot-ssh/config: No such file or directory
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
: exit status 128
debug: 2017/01/30 17:03:47 cli.go:23: exit status 128
exit status 128
bash-3.2$ 
bash-3.2$ # Last minute config
bash-3.2$ cat Dockerfile
bash-3.2$ cp ~/dot-ssh/git_pubkey_rsa key_sous@example.com
bash-3.2$ cp $(which sous) .
bash-3.2$ ls -la
bash-3.2$ ssh-keyscan -p 2222 192.168.99.100 > known_hosts
# 192.168.99.100:2222 SSH-2.0-OpenSSH_7.2p2-hpn14v4
# 192.168.99.100:2222 SSH-2.0-OpenSSH_7.2p2-hpn14v4
# 192.168.99.100:2222 SSH-2.0-OpenSSH_7.2p2-hpn14v4
bash-3.2$ cat known_hosts
bash-3.2$ 
bash-3.2$ git add key_sous@example.com known_hosts sous
bash-3.2$ git commit -am "Adding ephemeral files"
bash-3.2$ git tag -am "0.0.2" 0.0.2
bash-3.2$ git push
ssh_wrapper
Warning: Permanently added '[192.168.99.100]:2222' (ECDSA) to the list of known hosts.
To ssh://192.168.99.100:2222/repos/sous-server
   23ea27c..bd95e77  master -> master
bash-3.2$ git push --tags
ssh_wrapper
Warning: Permanently added '[192.168.99.100]:2222' (ECDSA) to the list of known hosts.
To ssh://192.168.99.100:2222/repos/sous-server
 * [new tag]         0.0.2 -> 0.0.2
bash-3.2$ sous context
bash-3.2$ pwd
bash-3.2$ sous build
bash-3.2$ # We expect to see 'Sous is running ... in workstation mode' here:
bash-3.2$ SOUS_SERVER= SOUS_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz<_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz9                         2mrn16vkfds/T/sous-cli-te<rs/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-tes                         ting238723182/gdm sous de<mrn16vkfds/T/sous-cli-testing238723182/gdm sous dep                         loy -cluster left
warn: No server set, Sous is running in server or workstation mode.
warn: Configure a server like this: sous config server http://some.sous.server
warn: Using local state stored at /var/folders/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-testing238723182/gdm
No manifest found for {"192.168.99.100/2222/repos/sous-server" "left"} - try 'sous init' first.
No manifest found for {"192.168.99.100/2222/repos/sous-server" "left"} - try 'sous init' first.
bash-3.2$ SOUS_SERVER= SOUS_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz<_STATE_LOCATION=/var/folders/sp/wllf_wh92p725fl4vz9                         2mrn16vkfds/T/sous-cli-te<rs/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-tes                         ting238723182/gdm sous de<mrn16vkfds/T/sous-cli-testing238723182/gdm sous dep                         loy -cluster right
warn: No server set, Sous is running in server or workstation mode.
warn: Configure a server like this: sous config server http://some.sous.server
warn: Using local state stored at /var/folders/sp/wllf_wh92p725fl4vz92mrn16vkfds/T/sous-cli-testing238723182/gdm
No manifest found for {"192.168.99.100/2222/repos/sous-server" "right"} - try 'sous init' first.
No manifest found for {"192.168.99.100/2222/repos/sous-server" "right"} - try 'sous init' first.
bash-3.2$ popd
bash-3.2$ 
bash-3.2$ 